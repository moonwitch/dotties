##################################################################
# i3 config file (v4)
# Please see https://i3wm.org/docs/userguide.html for a complete reference!

######################
# Autostart setup
######################
exec --no-startup-id picom -b
exec --no-startup-id feh --no-fehbg --bg-fill $WALLPAPER 
exec --no-startup-id dunst -config $HOME/.config/dunst/dunstrc-nord
exec --no-startup-id numlockx
exec --no-startup-id /usr/local/bin/QNAP/QsyncClient/Qsync.sh
exec --no-startup-id udiskie --smart-tray
exec --no-startup-id nm-applet
exec --no-startup-id code
exec --no-startup-id google-chrome-stable
exec_always --no-startup-id $HOME/.config/polybar/launch.sh

######################
# Looks setup
######################
# Gaps
for_window [class=".*"] border pixel 2
gaps outer 10
gaps inner 10
smart_gaps on
smart_borders on
#border_radius 4

# Few little adds
default_orientation auto
workspace_auto_back_and_forth yes
popup_during_fullscreen smart
force_focus_wrapping yes
force_display_urgency_hint 500 ms

# Font for Windows titles and bar, unless otherwise specified
font pango:Overpass Mono 12

# # .Xresources-based colorscheme
set_from_resource $foreground i3wm.foreground
set_from_resource $background i3wm.background
set_from_resource $color0 i3wm.color0
set_from_resource $color1 i3wm.color1
set_from_resource $color2 i3wm.color2
set_from_resource $color3 i3wm.color3
set_from_resource $color4 i3wm.color4
set_from_resource $color5 i3wm.color5
set_from_resource $color6 i3wm.color6
set_from_resource $color7 i3wm.color7
set_from_resource $color8 i3wm.color8
set_from_resource $color9 i3wm.color9
set_from_resource $color10 i3wm.color10
set_from_resource $color11 i3wm.color11
set_from_resource $color12 i3wm.color12
set_from_resource $color13 i3wm.color13
set_from_resource $color14 i3wm.color14
set_from_resource $color15 i3wm.color15

#bar {
#    position top
#    status_command i3xrocks -c $HOME/.config/i3/blocks
#
#    workspace_buttons      yes
#    colors {
#        background $background
#        separator  $foreground
#        statusline $foreground
#
#        # State             Border  BG      Text
#        focused_workspace   $color7 $color4 $background
#        active_workspace    $color7 $color3 $background
#        inactive_workspace  $color8 $color8 $foreground
#        urgent_workspace    $color1 $color9 $background
#        binding_mode        $background $color4 $background
#    }
#}


# Basic color configuration using the variables for windows and borders.
# Property Name         Border        BG          Text        Indicator   Child Border
client.focused          $color7       $color4    $foreground $color11    $color9
client.focused_inactive $color0       $color8     $foreground $color8     $color0
client.unfocused        $color0       $background $foreground $color0     $color0
client.urgent           $color6       $color1     $foreground $color6     $color6
client.placeholder      $background   $background $foreground $background $background
client.background       $color14

######################
# Keybind setup
######################
# set modifier
set $super Mod4
set $alt Mod1

# Use $super+Mouse to drag floating windows to their wanted position
floating_modifier $super

bindsym XF86AudioRaiseVolume exec --no-startup-id pactl set-sink-volume @DEFAULT_SINK@ +5% && pkill -RTMIN+9 i3xrocks
bindsym XF86AudioLowerVolume exec --no-startup-id pactl set-sink-volume @DEFAULT_SINK@ -5% && pkill -RTMIN+9 i3xrocks
bindsym XF86AudioMute exec --no-startup-id pactl set-sink-mute @DEFAULT_SINK@ toggle && pkill -RTMIN+9 i3xrocks

bindsym XF86AudioPlay exec --no-startup-id playerctl play-pause
bindsym XF86AudioPause exec --no-startup-id playerctl play-pause
bindsym XF86AudioNext exec --no-startup-id playerctl next
bindsym XF86AudioPrev exec --no-startup-id playerctl previous

# Screenshots (requires `maim`)
bindsym Print exec "i3-shotter -s"
bindsym Control+Print exec "i3-shotter -w"
bindsym $alt+Print exec "i3-shotter -f"

# Commonly used Apps
bindsym $super+Return exec $TERMINAL
bindsym $super+Shift+Return exec $TERMINAL -e vifm
bindsym $super+Shift+w exec $BROWSER
bindsym $super+Shift+e exec $FILEMAN
bindsym XF86Calculator exec --no-startup-id galculator

# start rofi
bindsym $super+space exec "rofi -show drun -theme themes/FlatnGroovy.rasi"
# Alt tab
bindsym $alt+Tab exec "rofi -kb-accept-entry '!Alt-Tab' -kb-row-down Alt-Tab -show window -theme themes/FlatnGroovy.rasi"

# kill focused window
bindsym $super+Shift+q kill

# switch focused window
bindsym $super+Left focus left
bindsym $super+Down focus down
bindsym $super+Up focus up
bindsym $super+Right focus right

# move focused window
bindsym $super+Shift+Left move left
bindsym $super+Shift+Down move down
bindsym $super+Shift+Up move up
bindsym $super+Shift+Right move right

# split in horizontal orientation
bindsym $super+h split h

# split in vertical orientation
bindsym $super+v split v

# enter fullscreen mode for the focused container
bindsym $super+f fullscreen toggle

# change container layout (stacked, tabbed, toggle split)
bindsym $super+s layout stacking
bindsym $super+w layout tabbed
bindsym $super+e layout toggle split

# toggle tiling / floating
bindsym $super+Shift+space floating toggle

# focus the parent container
bindsym $super+a focus parent

# Define names for default workspaces for which we configure key bindings later on.
# Name the workspaces
set $ws1 " 1  "
set $ws2 " 2  "
set $ws3 " 3  "
set $ws4 " 4  "
set $ws5 " 5  "
set $ws6 " 6  "
set $ws7 " 7  "
set $ws8 " 8  "
set $ws9 " 9  "

# Switch to workspace
bindsym $super+1 workspace $ws1
bindsym $super+2 workspace $ws2
bindsym $super+3 workspace $ws3
bindsym $super+4 workspace $ws4
bindsym $super+5 workspace $ws5
bindsym $super+6 workspace $ws6
bindsym $super+7 workspace $ws7
bindsym $super+8 workspace $ws8
bindsym $super+9 workspace $ws9

# switch between workspaces
bindsym $super+Tab workspace next
bindsym $super+Shift+Tab workspace prev

# Move focused container to workspace
bindsym $super+Shift+1 move container to workspace $ws1
bindsym $super+Shift+2 move container to workspace $ws2
bindsym $super+Shift+3 move container to workspace $ws3
bindsym $super+Shift+4 move container to workspace $ws4
bindsym $super+Shift+5 move container to workspace $ws5
bindsym $super+Shift+6 move container to workspace $ws6
bindsym $super+Shift+7 move container to workspace $ws7
bindsym $super+Shift+8 move container to workspace $ws8
bindsym $super+Shift+9 move container to workspace $ws9

##################
### Power Mode ###
##################
set $Pause  [L]ock, [E]xit, [S]uspend, [R]eboot, [END] Shutdown
mode "$Pause" {
    bindsym e       exec --no-startup-id i3-msg exit,           mode "default"
    bindsym s       exec --no-startup-id systemctl suspend,     mode "default"
    bindsym r       exec --no-startup-id systemctl reboot,      mode "default"
    bindsym End     exec --no-startup-id systemctl poweroff -i, mode "default"
    bindsym l       exec betterlockscreen -l dimblur,           mode "default"

    bindsym Return  mode "default"
    bindsym Escape  mode "default"
}
bindsym $super+Shift+End mode "$Pause" 

bindsym XF86Sleep exec systemctl suspend

# reload the configuration file
bindsym $super+Shift+c reload

# restart i3 inplace (preserves your layout/session, can be used to upgrade i3)
bindsym $super+Shift+r restart

##############
### Resize ###
##############
mode "resize" {
    # These bindings trigger as soon as you enter the resize mode
    bindsym Left resize shrink width 10 px or 10 ppt
    bindsym Down resize grow height 10 px or 10 ppt
    bindsym Up resize shrink height 10 px or 10 ppt
    bindsym Right resize grow width 10 px or 10 ppt

    # back to normal: Enter or Escape or $super+r
    bindsym Return mode "default"
    bindsym Escape mode "default"
    bindsym $super+r mode "default"
}

bindsym $super+r mode "resize"

################
# Scratchpad ###
################
# Make the currently focused window a scratchpad
bindsym $super+Shift+minus move scratchpad
# Show the first scratchpad window
bindsym $super+minus scratchpad show

######################
# Workspaces setup
######################
# switch to workspace with urgent window automatically
focus_on_window_activation smart
for_window [urgent="latest" class="^Mattermost$"]   focus
for_window [urgent="latest" class="^Chromium$"]     focus
for_window [urgent="latest" class="^Firefox$"]      focus
for_window [class=URxvt|Alacritty|termite]     focus

# Change the default layout of specific workspaces
for_window [workspace=$ws3] layout tabbed
for_window [workspace=$ws8] layout tabbed

# Syntax
# assign <criteria> [→] [workspace] [number] <workspace>
# Base - Ws1
assign          [class=Chromium|Chrome]         $ws1
# Code - Ws2
assign          [class=Atom]                    $ws2
assign          [class="^Code$"]                $ws2
# Cmd - Ws3
# FileManager - Ws4
assign          [class=Thunar|Nemo|PCmanFM|Polo-GTK]     $ws4
# Server - Ws5
assign          [class=Vmrc]                    $ws5
assign          [class="^Remmina$"]             $ws5
assign          [class=Wfica]                   $ws5
# Office/Work - Ws6
assign          [class=LibreOffice*]            $ws6
assign          [class=Typora|zettlr|Notable]   $ws6
# Social - Ws7
assign          [class=Caprine]                 $ws7
assign          [class=Mattermost]              $ws7
assign          [class=Pidgin]                  $ws7
assign          [class=Skype]                   $ws7
assign          [class=Discord]                 $ws7
assign          [class=Teams]                   $ws7
assign          [class=Slack]                   $ws7
# Music - Ws8
# Because Spotify is a bitch
for_window [class="Spotify"] move to workspace $ws8
# Games - Ws9
assign          [class="^Steam"]               $ws9
assign          [class=Lutris]                 $ws9

# Enable float for some windows and if need be give them a size
for_window      [class="^Pavucontrol$"]         floating enable, resize set 1500 750, focus
for_window      [class="^Arandr$"]              floating enable
for_window      [class=zathura|mupdf]           floating enable
for_window      [class=feh]                     floating enable
for_window      [class=Lxappearance]            floating enable
for_window      [class=Pamac-manager]           floating enable, resize set 1500 750
for_window      [class="Simple-scan"]           floating enable
for_window      [class="Yad|Zenity"]            floating enable
for_window      [class="Pidgin" instance="Pidgin" title="Buddy List"] floating enable, resize set 500 850
for_window      [class="Peek"]                  floating enable
for_window      [title="Floating Terminal"]     floating enable

for_window      [window_role="pop-up"]          floating enable
for_window      [window_role="bubble"]          floating enable 
for_window      [window_role="task_dialog"]     floating enable
for_window      [window_role="Preferences"]     floating enable
for_window      [window_type="dialog"]          floating enable 
for_window      [window_type="menu"]            floating enable
# Other specific
for_window [title="feh.*/tmp/qr_code.png$"]     floating enable, sticky enable
for_window [title="Notepad Terminal"]           floating enable, move right 600
for_window [window_role="GtkFileChooserDialog"] resize set 900 600, move position center

# vim:ft=i3config
